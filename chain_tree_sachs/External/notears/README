Copied and adapted from DAGs with NO TEARS (https://github.com/xunzheng/notears/)